import{o as t,c as s,B as re,n as z,u as Q,s as R,a as o,t as i,d as r,e as le,x,w as S,g as y,r as N,F as B,b as V,h as P,i as L,v as q,f as C,z as ce}from"./NvsA0GEm.js";import{_ as ne}from"./qmAVsE0u.js";import{_ as ue}from"./C1X4csih.js";import"./CC4BC_rW.js";const de={__name:"Main2",setup(f){return(m,p)=>(t(),s("div",{class:z(["grid gap-2 sm:gap-4",Q(R)?"grid-cols-2 sm:grid-cols-2 md:grid-cols-2 2xl:grid-cols-3":"grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"])},[re(m.$slots,"default")],2))}},ie={class:"aspect-square"},ve=["src"],pe={class:"flex size-full items-center p-2"},ge={class:"font-sans text-sm font-normal leading-normal text-gray-900 antialiased"},he={__name:"CategoryCard2",props:{category:Object,onSelect:Function},setup(f){return(m,p)=>(t(),s("div",{onClick:p[0]||(p[0]=j=>f.onSelect(f.category)),class:"flex h-16 cursor-pointer items-center rounded-xl border bg-white bg-clip-border text-gray-700 transition-all duration-300 hover:shadow-md"},[o("div",ie,[o("img",{src:f.category.photo,alt:"category-image",class:"h-16 rounded-l-md object-cover object-center"},null,8,ve)]),o("div",pe,[o("p",ge,i(f.category.name),1)])]))}},_e={class:"col-span-3 overflow-auto border bg-white md:col-span-2"},ye={class:"p-3 text-lg font-bold"},fe={class:"overflow-auto"},me=["onClick"],be={class:"text-sm font-medium"},we={key:0},ke={class:"text-base text-gray-500"},xe={key:0},Se={key:0},Ce=o("p",null,"Cargando productos...",-1),$e=[Ce],Be={key:1},Pe=o("h6",{class:"p-3 text-lg font-bold"},"Buscar Productos en Subcategoría",-1),je={key:0},Ae={key:1},Fe=o("h6",{class:"p-3 text-lg font-bold"},"Productos",-1),Ee={key:1},Me={key:0},Ne=o("p",null,"Cargando subcategorías...",-1),Ve=[Ne],Le={key:1},qe=o("h6",{class:"p-3 text-lg font-bold"},"Buscar Productos en Categoría",-1),ze={key:0},Ie={key:1},Te=o("h6",{class:"p-3 text-lg font-bold"},"Subcategorías",-1),Ue={key:2},Oe={key:0},Qe=o("p",null,"Cargando categorías...",-1),Re=[Qe],De={key:1},Ge=o("h6",{class:"p-3 text-lg font-bold"},"Buscar Productos",-1),He={key:0},Je={key:1},Ke=o("h6",{class:"p-3 text-lg font-bold"},"Categorías",-1),We={key:1,class:"size-full bg-white"},ot={__name:"index",setup(f){const m=e=>{ce(e,{supplierProductId:e.id,unitOfMeasure:e.unitOfMeasure})},p=e=>{console.log("Selected product",e.id)},j=r([]),D=r(!0),n=r(null),g=r(null),d=r(null),I=r([]),T=r([]),U=r([]),A=r([]),b=r([]),h=r([]),w=r(""),v=r(""),u=r(""),F=r(!1),E=r(!1),M=r(!1),$=r(!1),k=r(!1),G=async()=>{try{const e=await fetch(y("//guest/proveedores/getsuppliers"));if(!e.ok)throw new Error("Failed to fetch suppliers");const a=await e.json();j.value=a.data}catch(e){console.error(e)}finally{D.value=!1}},H=async e=>{try{F.value=!0;const a=await fetch(y(`/guest/proveedores/getcategoriesbysupplier/${e}`));if(!a.ok)throw new Error("Failed to fetch categories");const l=await a.json();I.value=l.data}catch(a){console.error(a)}finally{F.value=!1}},J=async(e,a)=>{try{E.value=!0;const l=await fetch(y(`/guest/proveedores/getsubcategoriesbysupplier/${e}/${a}`));if(!l.ok)throw new Error("Failed to fetch subcategories");const _=await l.json();T.value=_.data,$.value=!0,k.value=!1}catch(l){console.error(l)}finally{E.value=!1}},K=async(e,a)=>{try{M.value=!0;const l=await fetch(y(`/guest/proveedores/getproductsbysupplier/${e}/subcategory/${a}`));if(!l.ok)throw new Error("Failed to fetch products");const _=await l.json();U.value=_.data,k.value=!0}catch(l){console.error(l)}finally{M.value=!1}},W=async()=>{if(n.value)try{const e=await fetch(y(`/guest/proveedores/searchProductsBySupplier/${n.value.id}?query=${w.value}`));if(!e.ok)throw new Error("Failed to search products");const a=await e.json();A.value=a.data}catch(e){console.error(e)}},X=async()=>{if(!(!n.value||!g.value))try{const e=await fetch(y(`/guest/proveedores/searchProductsBySupplierAndCategory/${n.value.id}/${g.value.id}?query=${v.value}`));if(!e.ok)throw new Error("Failed to search products in category");const a=await e.json();b.value=a.data}catch(e){console.error(e)}},Y=async()=>{if(!(!n.value||!d.value))try{const e=await fetch(y(`/guest/proveedores/searchProductsBySubcategoryAndSupplier/${n.value.id}/${d.value.id}?query=${u.value}`));if(!e.ok)throw new Error("Failed to search products in subcategory");const a=await e.json();h.value=a.data}catch(e){console.error(e)}},Z=e=>{n.value=e,g.value=null,d.value=null,H(e.id),$.value=!1,k.value=!1,w.value="",v.value="",u.value="",A.value=[],b.value=[],h.value=[]},ee=e=>{g.value=e,d.value=null,J(n.value.id,e.id),v.value="",u.value="",b.value=[],h.value=[]},te=e=>{d.value=e,K(n.value.id,e.slug),u.value="",h.value=[]},oe=()=>{$.value=!1,k.value=!1,g.value=null,d.value=null,v.value="",u.value="",b.value=[],h.value=[]},se=()=>{k.value=!1,$.value=!0,d.value=null,u.value="",h.value=[]};return le(()=>{G()}),(e,a)=>{const l=de,_=ne,O=he,ae=ue;return t(),x(ae,{class:"max-h-[calc(100vh_-_100px)]"},{default:S(()=>[o("div",_e,[o("h6",ye,"Proveedores - "+i(j.value.length),1),o("div",fe,[(t(!0),s(B,null,N(j.value,c=>(t(),s("div",{key:c.id,class:z(["cursor-pointer border-t p-3 hover:bg-primary-400",{"bg-primary-400 text-white":n.value&&n.value.id===c.id}]),onClick:Xe=>Z(c)},[o("h2",be,i(c.name),1)],10,me))),128))])]),o("div",{class:z(["hidden h-full overflow-auto rounded-lg md:block",Q(R)?"col-span-2 2xl:col-span-3":"col-span-2 lg:col-span-3 xl:col-span-4 2xl:col-span-5"])},[n.value?(t(),s("div",we,[o("p",ke,[V(i(n.value.name)+" ",1),g.value?(t(),s(B,{key:0},[V(" / "+i(g.value.name),1)],64)):P("",!0),d.value?(t(),s(B,{key:1},[V(" / "+i(d.value.name),1)],64)):P("",!0)]),k.value?(t(),s("div",xe,[o("button",{onClick:se,class:"mb-4 text-sm text-blue-500 underline"},"Atrás a Subcategorías"),M.value?(t(),s("div",Se,$e)):(t(),s("div",Be,[o("div",null,[Pe,L(o("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=c=>u.value=c),onInput:Y,placeholder:"Buscar productos...",class:"mb-4 w-full rounded border p-2"},null,544),[[q,u.value]]),u.value?(t(),s("div",je,[h.value.length?(t(),x(l,{key:0})):(t(),s("p",Ae,'No se encontraron resultados para "'+i(u.value)+'"',1))])):P("",!0)]),o("div",null,[Fe,C(l,null,{default:S(()=>[C(_,{products:U.value,onAgregar:m,updatePrice:p},null,8,["products"])]),_:1})])]))])):$.value?(t(),s("div",Ee,[o("button",{onClick:oe,class:"mb-4 text-sm text-blue-500 underline"},"Atrás a Categorías"),E.value?(t(),s("div",Me,Ve)):(t(),s("div",Le,[o("div",null,[qe,L(o("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=c=>v.value=c),onInput:X,placeholder:"Buscar productos...",class:"mb-4 w-full rounded border p-2"},null,544),[[q,v.value]]),v.value?(t(),s("div",ze,[b.value.length?(t(),x(l,{key:0},{default:S(()=>[C(_,{products:b.value,onAgregar:m,updatePrice:p},null,8,["products"])]),_:1})):(t(),s("p",Ie,'No se encontraron resultados para "'+i(v.value)+'"',1))])):P("",!0)]),o("div",null,[Te,C(l,null,{default:S(()=>[(t(!0),s(B,null,N(T.value,c=>(t(),x(O,{key:c.id,category:c,onSelect:te},null,8,["category"]))),128))]),_:1})])]))])):(t(),s("div",Ue,[F.value?(t(),s("div",Oe,Re)):(t(),s("div",De,[o("div",null,[Ge,L(o("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=c=>w.value=c),onInput:W,placeholder:"Buscar productos...",class:"mb-4 w-full rounded border p-2"},null,544),[[q,w.value]]),w.value?(t(),s("div",He,[A.value.length?(t(),x(l,{key:0},{default:S(()=>[C(_,{products:A.value,onAgregar:m,updatePrice:p},null,8,["products"])]),_:1})):(t(),s("p",Je,'No se encontraron resultados para "'+i(w.value)+'"',1))])):P("",!0)]),o("div",null,[Ke,C(l,null,{default:S(()=>[(t(!0),s(B,null,N(I.value,c=>(t(),x(O,{key:c.id,category:c,onSelect:ee},null,8,["category"]))),128))]),_:1})])]))]))])):(t(),s("div",We))],2)]),_:1})}}};export{ot as default};
